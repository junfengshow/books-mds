"use strict";(self.webpackChunkbooks_mds=self.webpackChunkbooks_mds||[]).push([[904],{9168:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(28077),o={}},27170:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(8619),o={}},53397:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(76094),o={}},82908:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(18810),o={}},11171:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(68537),o={}},87925:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(57380),o={}},68499:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(76701),o={}},75388:function(a,e,n){n.r(e),n.d(e,{demos:function(){return E}});var r=n(15009),t=n.n(r),o=n(99289),m=n.n(o),c=n(67294),f=n(24155),E={"docs-webgl-shapes-s-1-sumary-demo-0":{component:c.memo(c.lazy(m()(t()().mark(function l(){var _,u;return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.resolve().then(n.t.bind(n,67294,19));case 2:return _=s.sent,u=_.default,s.abrupt("return",{default:function(){return u.createElement(u.Fragment,null,"Hello world!")}});case 5:case"end":return s.stop()}},l)})))),asset:{type:"BLOCK",id:"docs-webgl-shapes-s-1-sumary-demo-0",refAtomIds:[],dependencies:{"index.jsx":{type:"FILE",value:`import React from 'react';

export default () => <>Hello world!</>;`},react:{type:"NPM",value:"18.3.1"}},entry:"index.jsx",description:"descriptiondescriptiondescription",title:"demo \u6807\u9898"},context:{react:n(67294)},renderOpts:{compile:function(){var l=m()(t()().mark(function u(){var i,s=arguments;return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,n.e(335).then(n.bind(n,37335));case 2:return d.abrupt("return",(i=d.sent).default.apply(i,s));case 3:case"end":return d.stop()}},u)}));function _(){return l.apply(this,arguments)}return _}()}},"docs-webgl-shapes-s-1-sumary-demo-1":{component:c.memo(c.lazy(m()(t()().mark(function l(){var _,u;return t()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Promise.resolve().then(n.t.bind(n,67294,19));case 2:return _=s.sent,u=_.default,s.abrupt("return",{default:function(){return u.createElement("iframe",{src:"http://localhost:8000/examples/materials-cubemap?isDemo=1",style:{height:800}})}});case 5:case"end":return s.stop()}},l)})))),asset:{type:"BLOCK",id:"docs-webgl-shapes-s-1-sumary-demo-1",refAtomIds:[],dependencies:{"index.jsx":{type:"FILE",value:`import React from 'react';

export default () => (
  <iframe
    src="http://localhost:8000/examples/materials-cubemap?isDemo=1"
    style={{ height: 800 }}
  ></iframe>
);`},react:{type:"NPM",value:"18.3.1"}},entry:"index.jsx",description:"descriptiondescriptiondescription",title:"demo \u6807\u9898"},context:{react:n(67294)},renderOpts:{compile:function(){var l=m()(t()().mark(function u(){var i,s=arguments;return t()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,n.e(335).then(n.bind(n,37335));case 2:return d.abrupt("return",(i=d.sent).default.apply(i,s));case 3:case"end":return d.stop()}},u)}));function _(){return l.apply(this,arguments)}return _}()}}}},83754:function(a,e,n){n.r(e),n.d(e,{demos:function(){return o}});var r=n(67294),t=n(33510),o={}},79126:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(28077);const t=[]},77771:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(8619);const t=[]},56175:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(76094);const t=[]},93698:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(18810);const t=[]},51446:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(68537);const t=[]},67408:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(57380);const t=[{value:"lldldd",paraId:0,tocIndex:0},{value:"ldld",paraId:1,tocIndex:0},{value:"ldl",paraId:2,tocIndex:0},{value:"dl",paraId:3,tocIndex:0},{value:`1
1`,paraId:4,tocIndex:0},{value:`1
1`,paraId:5,tocIndex:0},{value:`1
1
1`,paraId:6,tocIndex:0}]},26108:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(76701);const t=[{value:"\u521A\u5F00\u59CB\u5B66\u4E60 webgl \u8D44\u6599\u4E00\u5927\u5806\u4E0D\u65B9\u4FBF\u4F7F\u7528\uFF0C\u6545\u5199\u70B9\u7B14\u8BB0\u65B9\u4FBF\u67E5\u9605\u3002",paraId:0,tocIndex:0},{value:`export class WebGLRenderer {
  domElement: HTMLCanvasElement;
  // @ts-ignore
  context: WebGLRenderingContext;
  constructor() {
    const canvas = document.createElement('canvas');
    canvas.className = 'canvas';
    this.domElement = canvas;

    this.setSize(600, 300);
  }

  setSize(width: number, height: number) {
    let canvas = this.domElement;
    if (this.context) {
      // \u4E3A\u4E86\u8BBE\u7F6E\u9ED8\u8BA4\u503C
      canvas = document.createElement('canvas');
      canvas.className = 'canvas';
      this.domElement = canvas;
    }
    canvas.style.width = width + 'px';
    canvas.style.height = height + 'px';
    canvas.width = width;
    canvas.height = height;

    this.context = canvas.getContext('webgl')!;
  }
  getContext() {
    return this.context;
  }
  createProgram(vSource: string, fSource: string) {
    const { context } = this;
    const program = context.createProgram()!;
    const vShader = this.loadShader(vSource, context.VERTEX_SHADER);
    const fShader = this.loadShader(fSource, context.FRAGMENT_SHADER);
    vShader && context.attachShader(program, vShader);
    fShader && context.attachShader(program, fShader);
    context.linkProgram(program);
    context.useProgram(program);
    return program;
  }
  loadShader(source: string, type: number) {
    const { context } = this;
    const shader = context.createShader(type)!;
    context.shaderSource(shader, source);
    context.compileShader(shader);
    if (!context.getShaderParameter(shader, context.COMPILE_STATUS)) {
      console.log(context.getShaderInfoLog(shader));
      return null;
    }
    return shader;
  }
  dispose() {
    this.domElement.parentNode?.removeChild(this.domElement);
  }
}
`,paraId:1,tocIndex:1},{value:`import { useEffect, useRef } from 'react';

interface IProps {
  drawMain?: (
    dom: HTMLDivElement,
    gui: IGUI,
  ) => {
    destroy?: () => void;
    [key: string]: any;
  } | void;
}

const NativeContainer: React.FC<IProps> = ({ drawMain }) => {
  const contentRef = useRef<HTMLDivElement>(null);
  const stateRef = useRef<{
    gui: IGUI;
    [key: string]: any;
  }>({
    // \u8BA9\u7C7B\u578B\u6709\u7701\u7684\u5199 ?
    gui: {} as IGUI,
  });
  useEffect(() => {
    const node = contentRef.current!;

    // \u53D7Sider\u5F71\u54CD node.offsetWidth\u5BBD\u5EA6\u4F1A\u5927\u4E00\u4E9B(Sider\u7684\u5BBD\u5EA6)
    setTimeout(() => {
      const res = drawMain?.(node, stateRef.current.gui);
      stateRef.current.res = res;

      if (res?.animate) {
        function animate() {
          stateRef.current.res.animate();
          stateRef.current.animateRes = requestAnimationFrame(animate);
        }
        animate();
      } else if (res?.render) {
        res.render();
      }
    });
    return () => {
      cancelAnimationFrame(stateRef.current.animateRes);
      stateRef.current.res?.destroy?.();
      stateRef.current.res?.renderer?.dispose?.();
    };
  }, []);
  return (
    <div className="flex">
      <div ref={contentRef} className="flex-auto" />
    </div>
  );
};
export default NativeContainer;
`,paraId:2,tocIndex:2}]},43911:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(24155);const t=[{value:`/**
 * background: '#333'
 */
const width = node.offsetWidth / 2,
  height = width,
  perSize = Float32Array.BYTES_PER_ELEMENT;

// \u6E32\u67D3\u5668
const renderer = new MyRender.WebGLRenderer();
renderer.setSize(width, height);
node.appendChild(renderer.domElement);

// program
const program = renderer.createProgram(vSource, fSource);
const gl = renderer.getContext();

// buffer
const buffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertex), gl.STATIC_DRAW);

const position = gl.getAttribLocation(program, 'position');
gl.vertexAttribPointer(position, 4, gl.FLOAT, false, perSize * 6, 0);
gl.enableVertexAttribArray(position);

const coord = gl.getAttribLocation(program, 'coord');
gl.vertexAttribPointer(coord, 2, gl.FLOAT, false, perSize * 6, perSize * 4);
gl.enableVertexAttribArray(coord);

// texture
const colorTexture = gl.createTexture();
const u_sampler = gl.getUniformLocation(program, 'u_sampler');
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, colorTexture);

gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);

/* prettier-ignore */
const data = new Uint8Array([
    255, 0, 0, 255, // \u7EA2\u8272
    255, 255, 0, 255, // \u9EC4\u8272
    0, 0, 255, 255, // \u84DD\u8272
    0, 255, 0, 255, // \u7EFF\u8272
  ]);

gl.texImage2D(
  gl.TEXTURE_2D,
  0,
  gl.RGBA,
  2,
  2,
  0,
  gl.RGBA,
  gl.UNSIGNED_BYTE,
  data,
);
gl.uniform1i(u_sampler, 0);

return {
  renderer,
  render() {
    gl.clearColor(0, 0, 0, 1);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
  },
};
`,paraId:0}]},33310:function(a,e,n){n.r(e),n.d(e,{texts:function(){return t}});var r=n(33510);const t=[{value:"fragment shader",paraId:0,tocIndex:2},{value:`varying vec2 v_pin;
uniform Sampler2D u_sampler;
void main () {
  gl_FragColor = texture2D(u_sampler, v_pin);
}
`,paraId:1,tocIndex:2},{value:"createTexture",paraId:2,tocIndex:3},{value:"pixelStorei",paraId:2,tocIndex:3},{value:"activeTexture",paraId:2,tocIndex:3},{value:"bindTexture",paraId:2,tocIndex:3},{value:"texParameteri",paraId:2,tocIndex:3},{value:"texImage2D",paraId:2,tocIndex:3},{value:"uniform1i",paraId:2,tocIndex:3},{value:`// texture
const u_sample = gl.getUniformLocation(program, 'u_sample');
const texture = gl.createTexture();
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture);

// prettier-ignore
const data = new Uint8Array([
    255, 0, 0, 255, 
    255, 255, 0, 255, 
    0, 255, 0, 255, 
    0, 0, 255, 255, 
  ])
// magnification
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
// minification
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
// wrapping
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);

gl.texImage2D(
  gl.TEXTURE_2D,
  0,
  gl.RGBA, // internalformat
  2,
  2,
  0,
  gl.RGBA, // format: webgl1 \u5FC5\u987B\u548Cinternalformat\u76F8\u540C
  gl.UNSIGNED_BYTE,
  data,
);
gl.uniform1i(u_sample, 0);
`,paraId:3,tocIndex:3}]}}]);
